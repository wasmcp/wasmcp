package wasmcp:http-transport@0.1.4;

world transport-base {
    include wasi:http/proxy@0.2.3;
    include wasmcp:mcp-v20250618/server-transport@0.1.3;

    // Servers MUST validate the Origin header on all incoming connections to prevent DNS rebinding attacks.
    // https://modelcontextprotocol.io/specification/2025-06-18/basic/transports#security-warning
    import wasi:cli/environment@0.2.3;
    import wasi:random/random@0.2.3;
}

world http-transport-draft2 {
    include transport-base;
    // Session support requires key-value storage and cryptographic random generation
    import wasi:keyvalue/store@0.2.0-draft2;
}