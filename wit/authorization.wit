package wasmcp:transport@0.2.0;

/// Authorization capabilities are provided at the transport level, enabling MCP clients to make requests to restricted MCP servers on behalf of resource owners.
///
/// https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization
interface authorization {
    use wasmcp:mcp/authorization-types@0.2.0.{provider-auth-config};

    /// Get provider's auth configuration
    /// The transport should enforce authorization
    get-auth-config: func() -> option<provider-auth-config>;

    /// Get cached JWKS for a given URI (optional - return none if not cached or not implemented)
    /// Allows providers to implement JWKS caching via WASI-KV or other persistence mechanisms
    /// The transport will call this before fetching from jwks-uri to check for cached keys
    jwks-cache-get: func(jwks-uri: string) -> option<string>;

    /// Cache JWKS for a given URI (optional - no-op if caching not implemented)
    /// The transport calls this after successfully fetching JWKS from jwks-uri
    /// Providers can implement caching via WASI-KV or other persistence mechanisms
    /// The jwks parameter contains the raw JWKS JSON string to cache
    jwks-cache-set: func(jwks-uri: string, jwks: string);
}
